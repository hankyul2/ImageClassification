# 1. load data
data:
  class_path: src.data.cifar.CIFAR10_DataModule
  init_args:
    dataset_name: cifar10
    batch_size: 64
    num_workers: 4
    size:
    - 224
    - 224
    data_root: data
    valid_ratio: 0.1

# 2. define model
model:
  class_path: src.system.base_vision_system.BaseVisionSystem
  init_args:
    backbone:
      class_path: src.model.resnet32.ResNet32
      init_args:
        class_num: 10
        hello: nn.BatchNorm
    in_features: 10
    num_classes: 10

    # 3. prepare train tools (optimizer, learning rate scheduler)
    optimizer_init:
      class_path: torch.optim.SGD
      init_args:
        lr: 0.03
        momentum: 0.95
        weight_decay: 0.0005
    lr_scheduler_init:
      class_path: src.lr_schedulers.CosineLR
      init_args:
        num_step: 400
        max_epoch: 100
        warmup_epoch: 1

# 4. train
seed_everything: null
trainer:
  # 4-1. gpu devices
  accelerator: null
  gpus: "4,"
  amp_backend: native

  # 4-2. train setting
  check_val_every_n_epoch: 1
  val_check_interval: 1.0
  max_epochs: null

  # 4-3. logger & callbacks
  logger: true
  log_every_n_steps: 50
  callbacks: null
  checkpoint_callback: true
  resume_from_checkpoint: null

  # 4-4. hyper param tuning
  auto_lr_find: false
  auto_scale_batch_size: false

  # 4-5. for debugging
  fast_dev_run: false
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  limit_predict_batches: 1.0

  # 4-6. etc
  profiler: null
  precision: 32
  multiple_trainloader_mode: max_size_cycle
